
server:
  port: 8004 # 项目启动的端口


spring:
  # --- RabbitMQ (Async Decoupling) ---
  rabbitmq:
    host: 192.168.33.10
    port: 5672
    username: admin
    password: admin
    # Producer Reliability Settings
    publisher-confirm-type: correlated # Callback when Broker receives message
    publisher-returns: true           # Callback if routing fails

    # Consumer Settings (Pre-configuration for Phase 3)
    listener:
      simple:
        acknowledge-mode: manual      # We will manually ACK in code
        prefetch: 50                  # Don't overwhelm the worker (Backpressure)
        retry:
          enabled: true
          initial-interval: 1000ms
          max-attempts: 3
          multiplier: 2.0

  jackson:
    date-format: yyyy-MM-dd HH:mm:ss # 全局时间格式
    time-zone: GMT+8  # 指定默认时区，除非时间字段已指定时区，否则 JSON 序列化时都会使用此时区
  #  nacos:
#    enabled: true
#    server-addr: 8.138.163.189:5000
#
#    # Namespace configuration
#    namespace: bilibili
#
#    # Authentication (if enabled on Nacos)
#    username: nacos
#    password: nacos
#
#    # Service configuration
#    service: ${spring.application.name}
#    group: DEFAULT_GROUP
#    cluster-name: DEFAULT
#
#    # Network settings - CRITICAL FOR CONNECTION
#    ip: ${spring.cloud.client.ip-address:}
#    port: ${server.port}

  redis:
    database: 0 # Redis 数据库索引（默认为 0）
    host: 192.168.33.10
    #Redis 服务器地址
    port: 6379 # Redis 服务器连接端口
#      password: qwe123!@# # Redis 服务器连接密码（默认为空）




  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver   # 指定数据库驱动类
    # 数据库连接信息
    url: jdbc:mysql://192.168.33.10:3306/Bilibili-test?useUnicode=true&characterEncoding=utf-8&autoReconnect=true&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root # 数据库用户名  A2qT03X7KlL4v/F2foD6kV/Ch9gpNBWOh1qoCywanjv1AsI7f9x3iAyR9NkUKeV+FMo+halCTzy5Llbk2VOrVQ== #
    password: root
    #数据库密码
    type: com.alibaba.druid.pool.DruidDataSource
    druid: # Druid 连接池
      initial-size: 5 # 初始化连接池大小
      min-idle: 5 # 最小连接池数量
      max-active: 20 # 最大连接池数量
      max-wait: 60000 # 连接时最大等待时间（单位：毫秒）
      test-while-idle: true
      time-between-eviction-runs-millis: 60000 # 配置多久进行一次检测，检测需要关闭的连接（单位：毫秒）
      min-evictable-idle-time-millis: 300000 # 配置一个连接在连接池中最小生存的时间（单位：毫秒）
      max-evictable-idle-time-millis: 900000 # 配置一个连接在连接池中最大生存的时间（单位：毫秒）
      validation-query: SELECT 1 FROM DUAL # 配置测试连接是否可用的查询 sql
      test-on-borrow: false
#      connectionProperties: config.decrypt=true;config.decrypt.key=MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAIgxn12aC9LP1qhUWpvBgKgEj2uBqYv87HLlet4haopZfTUzQlCAxu0MFcPvuckb77EQGWMTSs18TPNDRJ5K3v0CAwEAAQ==
      pool-prepared-statements: false
      web-stat-filter:
        enabled: true
      stat-view-servlet:
        enabled: true
        url-pattern: /druid/* # 配置监控后台访问路径
        login-username: admin # 配置监控后台登录的用户名、密码
        login-password: admin
      filter:
        config:
          enabled: false
        stat:
          enabled: true
          log-slow-sql: false # 开启慢 sql 记录
          slow-sql-millis: 2000 # 若执行耗时大于 2s，则视为慢 sql
          merge-sql: true
        wall: # 防火墙
          config:
            multi-statement-allow: true
  profiles:
    active: dev
  application:
    name: bilibili-comments-service
  main:
    lazy-initialization: true



logging:
  level:
    com.quanxiaoha.xiaohashu.auth.domain.mapper: debug


#mybatis:
#  # MyBatis xml 配置文件路径
#  mapper-locations: classpath:/mapper/**/*.xml


mybatis-plus:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl #开启sql日志
  mapper-locations: classpath*:/mapper/**/*.xml